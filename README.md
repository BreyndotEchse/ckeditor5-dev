CKEditor 5 development tools packages
=====================================

[![Build Status](https://travis-ci.org/ckeditor/ckeditor5-dev.svg?branch=master)](https://travis-ci.org/ckeditor/ckeditor5-dev)
[![Coverage Status](https://coveralls.io/repos/github/ckeditor/ckeditor5-dev/badge.svg?branch=master)](https://coveralls.io/github/ckeditor/ckeditor5-dev?branch=master)

## Packages

This repository is a monorepo. It contains multiple npm packages.

| Package | Version | Dependencies |
|---------|---------|--------------|
| [`@ckeditor/ckeditor5-dev-docs`](/packages/ckeditor5-dev-docs) | [![npm version](https://badge.fury.io/js/%40ckeditor%2Fckeditor5-dev-docs.svg)](https://www.npmjs.com/package/@ckeditor/ckeditor5-dev-docs) | [![Dependency Status](https://david-dm.org/ckeditor/ckeditor5-dev.svg?path=packages/ckeditor5-dev-docs)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/ckeditor5-dev-docs) [![devDependency Status](https://david-dm.org/ckeditor/ckeditor5-dev/dev-status.svg?path=packages/ckeditor5-dev-docs)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/ckeditor5-dev-docs&type=dev) |
| [`@ckeditor/ckeditor5-dev-env`](/packages/ckeditor5-dev-env) | [![npm version](https://badge.fury.io/js/%40ckeditor%2Fckeditor5-dev-env.svg)](https://www.npmjs.com/package/@ckeditor/ckeditor5-dev-env) | [![Dependency Status](https://david-dm.org/ckeditor/ckeditor5-dev.svg?path=packages/ckeditor5-dev-env)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/ckeditor5-dev-env) [![devDependency Status](https://david-dm.org/ckeditor/ckeditor5-dev/dev-status.svg?path=packages/ckeditor5-dev-env)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/ckeditor5-dev-env&type=dev) |
| [`@ckeditor/ckeditor5-dev-tests`](/packages/ckeditor5-dev-tests) | [![npm version](https://badge.fury.io/js/%40ckeditor%2Fckeditor5-dev-tests.svg)](https://www.npmjs.com/package/@ckeditor/ckeditor5-dev-tests) | [![Dependency Status](https://david-dm.org/ckeditor/ckeditor5-dev.svg?path=packages/ckeditor5-dev-tests)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/ckeditor5-dev-tests) [![devDependency Status](https://david-dm.org/ckeditor/ckeditor5-dev/dev-status.svg?path=packages/ckeditor5-dev-tests)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/ckeditor5-dev-tests&type=dev) |
| [`@ckeditor/ckeditor5-dev-utils`](/packages/ckeditor5-dev-utils) | [![npm version](https://badge.fury.io/js/%40ckeditor%2Fckeditor5-dev-utils.svg)](https://www.npmjs.com/package/@ckeditor/ckeditor5-dev-utils) | [![Dependency Status](https://david-dm.org/ckeditor/ckeditor5-dev.svg?path=packages/ckeditor5-dev-utils)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/ckeditor5-dev-utils) [![devDependency Status](https://david-dm.org/ckeditor/ckeditor5-dev/dev-status.svg?path=packages/ckeditor5-dev-utils)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/ckeditor5-dev-utils&type=dev) |
| [`@ckeditor/ckeditor5-dev-webpack-plugin`](/packages/ckeditor5-dev-webpack-plugin) | [![npm version](https://badge.fury.io/js/%40ckeditor%2Fckeditor5-dev-webpack-plugin.svg)](https://www.npmjs.com/package/@ckeditor/ckeditor5-dev-webpack-plugin) | [![Dependency Status](https://david-dm.org/ckeditor/ckeditor5-dev.svg?path=packages/ckeditor5-dev-webpack-plugin)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/ckeditor5-dev-webpack-plugin) [![devDependency Status](https://david-dm.org/ckeditor/ckeditor5-dev/dev-status.svg?path=packages/ckeditor5-dev-webpack-plugin)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/ckeditor5-dev-webpack-plugin&type=dev) |
| [`@ckeditor/jsdoc-plugins`](/packages/jsdoc-plugins) | [![npm version](https://badge.fury.io/js/%40ckeditor%2Fjsdoc-plugins.svg)](https://www.npmjs.com/package/@ckeditor/jsdoc-plugins) | [![Dependency Status](https://david-dm.org/ckeditor/ckeditor5-dev.svg?path=packages/jsdoc-plugins)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/jsdoc-plugins) [![devDependency Status](https://david-dm.org/ckeditor/ckeditor5-dev/dev-status.svg?path=packages/jsdoc-plugins)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/jsdoc-plugins&type=dev) |
| [`eslint-config-ckeditor5`](/packages/eslint-config-ckeditor5) | [![npm version](https://badge.fury.io/js/eslint-config-ckeditor5.svg)](https://www.npmjs.com/package/eslint-config-ckeditor5) | [![Dependency Status](https://david-dm.org/ckeditor/ckeditor5-dev.svg?path=packages/eslint-config-ckeditor5)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/eslint-config-ckeditor5) [![devDependency Status](https://david-dm.org/ckeditor/ckeditor5-dev/dev-status.svg?path=packages/eslint-config-ckeditor5)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/eslint-config-ckeditor5&type=dev) |
| [`eslint-plugin-ckeditor5-rules`](/packages/eslint-plugin-ckeditor5-rules) | [![npm version](https://badge.fury.io/js/eslint-plugin-ckeditor5-rules.svg)](https://www.npmjs.com/package/eslint-plugin-ckeditor5-rules) | [![Dependency Status](https://david-dm.org/ckeditor/ckeditor5-dev.svg?path=packages/eslint-plugin-ckeditor5-rules)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/eslint-plugin-ckeditor5-rules) [![devDependency Status](https://david-dm.org/ckeditor/ckeditor5-dev/dev-status.svg?path=packages/eslint-plugin-ckeditor5-rules)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/eslint-plugin-ckeditor5-rules&type=dev) |
| [`stylelint-config-ckeditor5`](/packages/stylelint-config-ckeditor5) | [![npm version](https://badge.fury.io/js/stylelint-config-ckeditor5.svg)](https://www.npmjs.com/package/stylelint-config-ckeditor5) | [![Dependency Status](https://david-dm.org/ckeditor/ckeditor5-dev.svg?path=packages/stylelint-config-ckeditor5)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/stylelint-config-ckeditor5) [![devDependency Status](https://david-dm.org/ckeditor/ckeditor5-dev/dev-status.svg?path=packages/stylelint-config-ckeditor5)](https://david-dm.org/ckeditor/ckeditor5-dev?path=packages/stylelint-config-ckeditor5&type=dev) |

## Cloning

1. Clone this repository.
2. Do `yarn install` inside (this package uses yarn workspaces).
3. You're ready to go!

## Testing

Tests:

```bash
yarn run test
```

Tests with the debug mode on:

```bash
DEBUG=true yarn run test
```

Test a single package:

```bash
./node_modules/.bin/mocha packages/ckeditor5-dev-env/tests/* --recursive
```

Code coverage:

```bash
yarn run coverage
```

## Releasing

1. Fetch all changes and switch to `master`!
1. Execute `yarn run changelog`.
	* This task check what changed in each package and bumps the version accordingly. If nothing changed at all, it won't create a new changelog entry. If changes were irrelevant (e.g. only depedencies) it will create an "internal changes" entry.
	* Scan the logs which are printed by the tool in search for errors (incorrect changelog entries). Incorrect entries (e.g. ones without the type) are being ignored. You may need to create entries for them manually. This is done directly in `CHANGELOG.md` of the specific package. Make sure to verify the proposed version after you modify the changelog.
   * When unsure what has really changed in this version of a specific package, use `git diff <hash of previous release> packages/ckeditor5-dev-<name>/`.
1. After reviewing the changelog and committing all changes do `git push`.
1. Now, you can release the changed packages by using `lerna publish`.
	* Lerna may propose to release more packages than you'd want – e.g. one of the packages might have some totally irrelevant change which you don't want to release now. You can do that by calling e.g.: `lerna publish --scope="@ckeditor/ckeditor5-dev-?(env|utils|webpack-plugin)"`. However, this means that if one of ignored packages depends on one of the release ones it won't have a version bump... so **usually it's better to just release everything**.
	* Lerna will propose to release more packages than the one in which new changelog entries were generated – those are packages which depend on the ones which were really updated. That's fine.
	* You need to pick version number of every package that Lerna wants to release. Do that based on what `yarn run changelog` proposed.
	* Finally, Lerna says it will publish also `ckeditor5-dev` itself. This isn't true as its a private package, but it will be tagged anyway. **Whenever there's a major release in any of the sub packages, make sure to pick major release of `ckeditor5-dev` too**. Thanks to that it's possible later to get back to the previous stable releases e.g. if a hot fix is needed.
1. Your job's done. You can go now to `ckeditor5`, remove `yarn.lock`, potentially update something in `package.json`, run `yarn install` and commit that as `"Internal: Updated dependencies."`.

## License

Licensed under the terms of [GNU General Public License Version 2 or later](http://www.gnu.org/licenses/gpl.html). For full details about the license, please check the `LICENSE.md` file.
